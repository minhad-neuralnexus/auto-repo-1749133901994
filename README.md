Code updated by mazain on 2025 